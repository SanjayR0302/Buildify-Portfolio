<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buildify - 3D Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            touch-action: none;
        }

        #threeCanvas {
            display: block;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            transition: opacity 0.5s ease;
        }

        .loading-screen h1 {
            color: #00ff88;
            font-size: 4rem;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .loading-screen p {
            color: #ccc;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .loading-bar {
            width: 300px;
            height: 6px;
            background: #333;
            margin-top: 20px;
            border-radius: 3px;
            overflow: hidden;
        }

        .loading-progress {
            height: 100%;
            background: #00ff88;
            width: 0%;
            transition: width 0.3s ease;
        }

        #progressText {
            color: #888;
            margin-top: 15px;
            font-size: 1rem;
        }

        /* UI Overlay */
        .ui-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        .nav-button {
            position: absolute;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            pointer-events: all;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
            z-index: 101;
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
        }

        .home-button {
            top: 30px;
            left: 30px;
        }

        .section-title {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 4rem;
            font-weight: 800;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
            pointer-events: none;
        }

        .section-title.visible {
            opacity: 1;
        }

        /* Portal Info */
        .portal-info {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .portal-info.visible {
            opacity: 1;
        }

        .portal-info h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #00ff88;
        }

        .portal-info p {
            font-size: 1rem;
            color: #ccc;
        }

        /* Mobile Controls */
        .mobile-controls {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: none;
            flex-direction: column;
            gap: 15px;
            z-index: 102;
        }

        .mobile-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            user-select: none;
            -webkit-user-select: none;
        }

        .mobile-button:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }

        /* Touch Selection Panel */
        .touch-selection {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 300px;
            z-index: 103;
            pointer-events: all;
        }

        .touch-portal {
            flex: 1;
            min-width: 120px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            text-align: center;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .touch-portal:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }

        .touch-portal.web { border-color: #00a8ff; }
        .touch-portal.app { border-color: #9c88ff; }
        .touch-portal.video { border-color: #e84118; }
        .touch-portal.design { border-color: #fbc531; }

        /* Responsive */
        @media (max-width: 768px) {
            .section-title {
                font-size: 2.5rem;
            }
            
            .mobile-controls {
                display: flex;
            }
            
            .touch-selection {
                display: flex;
            }
            
            .portal-info {
                bottom: 120px;
                width: 90%;
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <h1>BUILDIFY</h1>
        <p>Building your digital vision</p>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
        <p id="progressText">0%</p>
    </div>

    <!-- UI Overlay -->
    <div class="ui-overlay">
        <button id="homeButton" class="nav-button home-button" style="display: none;">
            ← Back to Home
        </button>
        
        <div id="sectionTitle" class="section-title"></div>
        <div class="portal-info" id="portalInfo"></div>
        
        <!-- Mobile Controls -->
        <div class="mobile-controls">
            <div class="mobile-button" id="rotateLeft">↶</div>
            <div class="mobile-button" id="rotateRight">↷</div>
            <div class="mobile-button" id="selectPortal">☰</div>
        </div>
        
        <!-- Touch Selection Panel -->
        <div class="touch-selection" id="touchSelection">
            <div class="touch-portal web" data-section="web">Web Dev</div>
            <div class="touch-portal app" data-section="app">App Dev</div>
            <div class="touch-portal video" data-section="video">Video</div>
            <div class="touch-portal design" data-section="design">Design</div>
        </div>
    </div>

    <!-- 3D Canvas -->
    <canvas id="threeCanvas"></canvas>

    <!-- Three.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    
    <script>
        let scene, camera, renderer, controls;
        let currentSection = 'home';
        let portals = [];
        let mouse = { x: 0, y: 0 };
        let stars;
        let isMobile = false;
        let isTouchSelectionOpen = false;

        // Portal configurations
        const portalConfigs = {
            web: { 
                color: 0x00a8ff, 
                title: 'WEB DEVELOPMENT', 
                description: 'Click to view web development projects',
                position: { x: 5, y: 3, z: 0 },
                page: 'web-projects.html'
            },
            app: { 
                color: 0x9c88ff, 
                title: 'APP DEVELOPMENT', 
                description: 'Click to view app development projects',
                position: { x: -5, y: 3, z: 0 },
                page: 'app-projects.html'
            },
            video: { 
                color: 0xe84118, 
                title: 'VIDEO EDITING', 
                description: 'Click to view video editing projects',
                position: { x: -5, y: -3, z: 0 },
                page: 'video-projects.html'
            },
            design: { 
                color: 0xfbc531, 
                title: 'DESIGN STUDIO', 
                description: 'Click to view design projects',
                position: { x: 5, y: -3, z: 0 },
                page: 'design-projects.html'
            }
        };

        // Initialize the application
        function init() {
            // Check if mobile device
            isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            createScene();
            createCamera();
            createRenderer();
            createControls();
            createLights();
            createStars(); // Add stars background
            createCentralLogo();
            createPortals();
            
            animate();
            setupEventListeners();
            simulateLoading();
        }

        // Create Three.js scene
        function createScene() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0a0a);
        }

        // Create stars background
        function createStars() {
            const starsGeometry = new THREE.BufferGeometry();
            const starsCount = 5000;
            const positions = new Float32Array(starsCount * 3);

            for (let i = 0; i < starsCount * 3; i++) {
                positions[i] = (Math.random() - 0.5) * 2000;
            }

            starsGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

            const starsMaterial = new THREE.PointsMaterial({
                color: 0xffffff,
                size: 1.5,
                sizeAttenuation: true
            });

            stars = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(stars);
        }

        // Create camera
        function createCamera() {
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 8);
        }

        // Create renderer
        function createRenderer() {
            renderer = new THREE.WebGLRenderer({ 
                canvas: document.getElementById('threeCanvas'),
                antialias: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        }

        // Create orbit controls
        function createControls() {
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.enableZoom = true;
            controls.enablePan = false;
            controls.maxPolarAngle = Math.PI / 2;
            controls.minDistance = 3;
            controls.maxDistance = 20;
            
            // Disable controls on mobile for better touch experience
            if (isMobile) {
                controls.enabled = false;
            }
        }

        // Create lighting
        function createLights() {
            // Ambient light
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);

            // Directional light
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(10, 10, 10);
            scene.add(directionalLight);

            // Point light
            const pointLight = new THREE.PointLight(0x00ff88, 0.5, 100);
            pointLight.position.set(0, 0, 5);
            scene.add(pointLight);
        }

        // Create central logo
        function createCentralLogo() {
            // Create a custom 3D "B" logo for Buildify
            const group = new THREE.Group();

            // Main B shape
            const bShape = new THREE.TorusGeometry(1.5, 0.3, 16, 100);
            const bMaterial = new THREE.MeshStandardMaterial({ 
                color: 0x00ff88,
                emissive: 0x00ff88,
                emissiveIntensity: 0.8
            });
            const bLogo = new THREE.Mesh(bShape, bMaterial);
            group.add(bLogo);

            // Additional elements for creativity
            const particlesGeometry = new THREE.BufferGeometry();
            const particleCount = 50;
            const posArray = new Float32Array(particleCount * 3);

            for(let i = 0; i < particleCount * 3; i++) {
                posArray[i] = (Math.random() - 0.5) * 4;
            }

            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            const particlesMaterial = new THREE.PointsMaterial({
                size: 0.1,
                color: 0x00a8ff
            });

            const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
            group.add(particlesMesh);

            scene.add(group);

            // Animation
            function animateLogo() {
                requestAnimationFrame(animateLogo);
                group.rotation.y += 0.02;
                group.rotation.x = Math.sin(Date.now() * 0.001) * 0.1;
                particlesMesh.rotation.y -= 0.01;
            }
            animateLogo();
        }

        // Create portals
        function createPortals() {
            Object.keys(portalConfigs).forEach(type => {
                createPortal(type, portalConfigs[type]);
            });
        }

        function createPortal(type, config) {
            const group = new THREE.Group();
            group.position.set(config.position.x, config.position.y, config.position.z);
            
            // Outer ring
            const ringGeometry = new THREE.TorusGeometry(1.5, 0.1, 16, 100);
            const ringMaterial = new THREE.MeshStandardMaterial({ 
                color: config.color,
                emissive: config.color,
                emissiveIntensity: 0.8
            });
            const ring = new THREE.Mesh(ringGeometry, ringMaterial);
            group.add(ring);

            // Portal surface
            const portalGeometry = new THREE.CircleGeometry(1.2, 32);
            const portalMaterial = new THREE.MeshStandardMaterial({
                color: config.color,
                transparent: true,
                opacity: 0.7,
                side: THREE.DoubleSide
            });
            const portal = new THREE.Mesh(portalGeometry, portalMaterial);
            group.add(portal);

            // Store portal data
            const portalData = {
                group: group,
                ring: ring,
                portal: portal,
                type: type,
                config: config,
                isActive: true
            };
            
            portals.push(portalData);
            scene.add(group);
        }

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate stars for background movement
            if (stars) {
                stars.rotation.x += 0.0001;
                stars.rotation.y += 0.0002;
            }
            
            // Rotate rings and add floating animation
            portals.forEach(portal => {
                if (portal.isActive) {
                    portal.ring.rotation.z += 0.02;
                    // Floating animation
                    portal.group.position.y = portal.config.position.y + Math.sin(Date.now() * 0.001 + portal.config.position.x) * 0.2;
                }
            });
            
            // Rotate entire scene when in home section
            if (currentSection === 'home' && !isMobile) {
                scene.rotation.y += 0.005;
            }
            
            controls.update();
            renderer.render(scene, camera);
        }

        // Setup event listeners
        function setupEventListeners() {
            // Mouse move for raycasting
            renderer.domElement.addEventListener('mousemove', onMouseMove);
            
            // Click for portal interaction
            renderer.domElement.addEventListener('click', onMouseClick);
            
            // Window resize
            window.addEventListener('resize', onWindowResize);
            
            // Home button
            document.getElementById('homeButton').addEventListener('click', goToHome);
            
            // Mobile controls
            document.getElementById('rotateLeft').addEventListener('click', () => rotateScene(-0.5));
            document.getElementById('rotateRight').addEventListener('click', () => rotateScene(0.5));
            document.getElementById('selectPortal').addEventListener('click', toggleTouchSelection);
            
            // Touch portal selection
            document.querySelectorAll('.touch-portal').forEach(portal => {
                portal.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    navigateToSection(section);
                    toggleTouchSelection(false);
                });
            });
            
            // Touch events for mobile
            if (isMobile) {
                renderer.domElement.addEventListener('touchstart', onTouchStart, { passive: false });
                renderer.domElement.addEventListener('touchmove', onTouchMove, { passive: false });
                renderer.domElement.addEventListener('touchend', onTouchEnd);
            }
        }

        // Mobile rotation function
        function rotateScene(amount) {
            scene.rotation.y += amount;
        }

        // Toggle touch selection panel
        function toggleTouchSelection(forceState) {
            const touchSelection = document.getElementById('touchSelection');
            if (forceState !== undefined) {
                isTouchSelectionOpen = forceState;
            } else {
                isTouchSelectionOpen = !isTouchSelectionOpen;
            }
            
            touchSelection.style.display = isTouchSelectionOpen ? 'flex' : 'none';
        }

        // Touch event handlers
        let touchStartX = 0;
        let touchStartY = 0;
        
        function onTouchStart(event) {
            if (event.touches.length === 1) {
                touchStartX = event.touches[0].clientX;
                touchStartY = event.touches[0].clientY;
                event.preventDefault();
            }
        }
        
        function onTouchMove(event) {
            if (event.touches.length === 1 && currentSection === 'home') {
                const touchX = event.touches[0].clientX;
                const deltaX = touchX - touchStartX;
                
                // Rotate scene based on touch movement
                scene.rotation.y += deltaX * 0.01;
                
                touchStartX = touchX;
                event.preventDefault();
            }
        }
        
        function onTouchEnd(event) {
            // Check if it was a tap (not a swipe)
            if (event.changedTouches.length === 1) {
                const touch = event.changedTouches[0];
                const deltaX = Math.abs(touch.clientX - touchStartX);
                const deltaY = Math.abs(touch.clientY - touchStartY);
                
                // If it was a tap (small movement), check for portal selection
                if (deltaX < 10 && deltaY < 10) {
                    // Convert touch position to normalized device coordinates
                    mouse.x = (touch.clientX / window.innerWidth) * 2 - 1;
                    mouse.y = -(touch.clientY / window.innerHeight) * 2 + 1;
                    
                    // Check for portal intersection
                    checkPortalIntersection();
                }
            }
        }

        function onMouseMove(event) {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            updatePortalHoverEffects();
        }

        function checkPortalIntersection() {
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            
            portals.forEach(portal => {
                if (!portal.isActive) return;
                
                const intersects = raycaster.intersectObject(portal.group, true);
                if (intersects.length > 0) {
                    navigateToSection(portal.type);
                }
            });
        }

        function onMouseClick() {
            if (!isMobile) { // Only use click for non-mobile
                const raycaster = new THREE.Raycaster();
                raycaster.setFromCamera(mouse, camera);
                
                portals.forEach(portal => {
                    if (!portal.isActive) return;
                    
                    const intersects = raycaster.intersectObject(portal.group, true);
                    if (intersects.length > 0) {
                        navigateToSection(portal.type);
                    }
                });
            }
        }

        function updatePortalHoverEffects() {
            if (isMobile) return; // Skip hover effects on mobile
            
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            
            let hoveredPortal = null;
            
            portals.forEach(portal => {
                if (!portal.isActive) return;
                
                const intersects = raycaster.intersectObject(portal.group, true);
                const isHovered = intersects.length > 0;
                
                // Update cursor
                renderer.domElement.style.cursor = isHovered ? 'pointer' : 'default';
                
                // Update portal appearance
                portal.ring.material.emissiveIntensity = isHovered ? 1.2 : 0.8;
                portal.portal.material.opacity = isHovered ? 0.9 : 0.7;
                
                if (isHovered) {
                    hoveredPortal = portal;
                }
            });
            
            // Update portal info display
            const portalInfo = document.getElementById('portalInfo');
            if (hoveredPortal && currentSection === 'home') {
                portalInfo.innerHTML = `
                    <h3>${hoveredPortal.config.title}</h3>
                    <p>${hoveredPortal.config.description}</p>
                `;
                portalInfo.classList.add('visible');
            } else {
                portalInfo.classList.remove('visible');
            }
        }

        function navigateToSection(section) {
            currentSection = section;
            
            // Update UI
            document.getElementById('homeButton').style.display = 'block';
            document.getElementById('sectionTitle').textContent = portalConfigs[section].title;
            document.getElementById('sectionTitle').classList.add('visible');
            
            // Disable portals
            portals.forEach(portal => {
                portal.isActive = false;
            });
            
            // Move camera to section view and then navigate to projects page
            const targetPosition = new THREE.Vector3(
                portalConfigs[section].position.x * 1.5,
                portalConfigs[section].position.y * 1.5,
                12
            );
            
            animateCamera(targetPosition, () => {
                // After camera animation completes, navigate to projects page
                setTimeout(() => {
                    window.location.href = portalConfigs[section].page;
                }, 1000);
            });
        }

        function goToHome() {
            currentSection = 'home';
            
            // Update UI
            document.getElementById('homeButton').style.display = 'none';
            document.getElementById('sectionTitle').classList.remove('visible');
            
            // Enable portals
            portals.forEach(portal => {
                portal.isActive = true;
            });
            
            // Move camera back to home position
            const homePosition = new THREE.Vector3(0, 0, 8);
            animateCamera(homePosition);
        }

        function animateCamera(targetPosition, onComplete) {
            const startPosition = camera.position.clone();
            const startTime = Date.now();
            const duration = 1000;
            
            function updateCamera() {
                const currentTime = Date.now();
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function
                const ease = 1 - Math.pow(1 - progress, 3);
                
                camera.position.lerpVectors(startPosition, targetPosition, ease);
                
                if (progress < 1) {
                    requestAnimationFrame(updateCamera);
                } else if (onComplete) {
                    onComplete();
                }
            }
            
            updateCamera();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function simulateLoading() {
            let progress = 0;
            const progressElement = document.querySelector('.loading-progress');
            const progressText = document.getElementById('progressText');
            const loadingScreen = document.getElementById('loadingScreen');
            
            const interval = setInterval(() => {
                progress += 2;
                progressElement.style.width = `${progress}%`;
                progressText.textContent = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        loadingScreen.style.opacity = '0';
                        setTimeout(() => {
                            loadingScreen.style.display = 'none';
                        }, 500);
                    }, 500);
                }
            }, 40);
        }

        // Start the application when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
